<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Student Echoes</title>
  <link rel="stylesheet" href="sign up.css"/>
</head>
<body>

  <div class="auth">
    <!-- Left visual panel -->
    <section class="visual">
      <header class="visual-top">
        <div class="brand">SE</div>
        <a href="#" class="back-link">Back to website</a>
      </header>
      <div class="visual-image" aria-hidden="true"></div>
      <footer class="visual-caption">
        <p>Capturing Moments, Creating Memories.</p>
      </footer>
    </section>

    <!-- Right form panel -->
    <section class="form-panel">
      <div class="form-wrap">
        <div class="form-header">
          <h1>Create an account</h1>
          <p class="sub">
            Already have an account?
            <a href="log in.html" id="signup-link">Log in</a>
          </p>
        </div>

        <form class="form" id="signup-form" novalidate>
          <div class="grid">
            <div class="field">
              <label for="firstName">First name</label>
              <input id="firstName" name="firstName" type="text" placeholder="Eugene" required />
            </div>
            <div class="field">
              <label for="lastName">Last name</label>
              <input id="lastName" name="lastName" type="text" placeholder="Dela Cruz" required />
            </div>
          </div>

          <div class="field">
            <label for="contact">Email or Phone Number</label>
            <input id="contact" name="contact" type="text" placeholder="you@example.com or +639123456789" required />
          </div>

          <div class="field password-field">
            <label for="password">Password</label>
            <div class="password-wrapper">
              <input id="password" name="password" type="password" placeholder="••••••••" required />
              <button type="button" id="togglePassword" class="toggle-password">Show</button>
            </div>
          </div>

          <div class="consent">
            <label class="checkbox">
              <input type="checkbox" id="terms" required />
              <span>I agree to the Terms & Conditions</span>
            </label>
          </div>

          <button class="primary-btn" type="submit">Create account</button>
        </form>
      </div>
    </section>
  </div>

  <script>
    /* sign-up.js
 *
 * Signup (create account) page script. Behavior for the demo:
 * - Validates required fields and terms checkbox
 * - Derives a display name from first+last name (or contact) and builds a
 *   userProfile object in the format expected by feed.js
 * - Persists the profile to localStorage under "userProfile" and sets "loggedIn"
 * - Redirects to feed.html
 *
 * In production you would POST the data to a server, validate on server,
 * create the account, and then use the server response to populate the profile.
 */
(function() {
  // Toggle password visibility
  const togglePassword = document.getElementById('togglePassword');
  const passwordInput = document.getElementById('password');

  if (togglePassword && passwordInput) {
    togglePassword.addEventListener('click', () => {
      const isPassword = passwordInput.type === 'password';
      passwordInput.type = isPassword ? 'text' : 'password';
      togglePassword.textContent = isPassword ? 'Hide' : 'Show';
    });
  }

  // Helper: derive display name from first/last or contact (email local part)
  function deriveDisplayNameFromForm(first, last, contact) {
    first = (first || '').trim();
    last = (last || '').trim();
    if (first || last) return (first + ' ' + last).trim();
    if (contact) {
      const at = contact.indexOf('@');
      if (at > 0) {
        const local = contact.slice(0, at).replace(/[._\-]+/g, ' ');
        return local.split(' ').map(w => w ? (w[0].toUpperCase() + w.slice(1)) : '').join(' ').trim() || 'User';
      }
      return contact;
    }
    return 'User';
  }

  // Helper: make userProfile object matching feed.js format
  function makeUserProfile(displayName, contact) {
    return {
      name: displayName,
      avatar: 'https://i.pravatar.cc/80?u=' + encodeURIComponent(contact || displayName),
      bio: '',
      joined: new Date().toLocaleDateString(),
      communitiesJoined: 0,
      joinedCommunities: []
    };
  }

  // Signup form submission handler
  const signupForm = document.getElementById('signup-form');
  if (signupForm) {
    signupForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const firstName = (document.getElementById('firstName').value || '').trim();
      const lastName = (document.getElementById('lastName').value || '').trim();
      const contact = (document.getElementById('contact').value || '').trim();
      const pwd = (document.getElementById('password').value || '').trim();
      const termsChecked = !!document.getElementById('terms').checked;

      if (!termsChecked) {
        alert('You must agree to the Terms & Conditions.');
        return;
      }
      if (!contact || !pwd) {
        alert('Please provide contact and password.');
        return;
      }

      // Simulate server success: create a profile and persist locally
      const displayName = deriveDisplayNameFromForm(firstName, lastName, contact);
      const profile = makeUserProfile(displayName, contact);

      try {
        // Write exact key feed.js expects
        localStorage.setItem('userProfile', JSON.stringify(profile));
        localStorage.setItem('loggedIn', 'true');
        localStorage.setItem('userEmail', contact);
      } catch (err) {
        console.warn('Could not save profile to localStorage', err);
      }

      // Redirect to feed; feed reads userProfile and shows the name everywhere
      window.location.href = 'feed.html';
    });
  }

  // "Log in" link should navigate to login page without auto-login in demo
  const signupLink = document.getElementById('signup-link');
  if (signupLink) {
    signupLink.addEventListener('click', function(e) {
      e.preventDefault();
      window.location.href = 'log in.html';
    });
  }
})();
  </script>
</body>
</html>